{% extends 'base/fix-nav.html' %}
{% load util_tag %}
{% block content %}
    {% if messages %}
        {% for message in messages %}
            <div style="margin:0 auto" class="text-center alert alert-success alert-dismissible fade show" role="alert">
                <strong>{{ message }}</strong>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        {% endfor %}
    {% endif %}
    <h1>{{ project.name }}</h1>
    <p>{{ project.name }}位于{{ project.address }}，项目经理为{{ project.manager }}。</p>

    <hr>

    <h2 class="text-center">项目财务数据</h2>
    <div class="row mb-3">
        <div class="col-xs-12 col-md-4">
            <p class="text-center">项目当前利润：<span class="badge badge-primary text-center">{{ project.detail.profit }}</span></p>
        </div>
        <div class="col-xs-12 col-md-4">
            <p class="text-center">项目净现金流：<span class="badge badge-primary text-center" >{{ project.detail.net_cash_flow }}</span></p>
        </div>
        <div class="col-xs-12 col-md-4 ">
            <p class="text-center">项目增值税：<span class="badge badge-primary" >{{ project.detail.net_vat }}</span></p>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-xs-12 col-md">
            <h3 class="text-center">项目当前状态</h3>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">内容</th>
                    <th scope="col">金额</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>累计确认收入</td>
                    <td>{{ project.detail.accumulated_revenue|comma }}</td>
                </tr>
                <tr>
                    <td>累计确认成本</td>
                    <td>{{ project.detail.accumulated_cost|comma }}</td>
                </tr>
                <tr>
                    <td>合同履约成本</td>
                    <td>{{ project.detail.capitalized_cost|comma }}</td>
                </tr>

                <tr>
                    <td>合同资产</td>
                    <td>{{ project.detail.contract_asset|comma }}</td>
                </tr>

                <tr>
                    <td>合同负债</td>
                    <td>{{ project.detail.contract_liability|comma }}</td>
                </tr>

                <tr>
                    <td>合同取得成本</td>
                    <td>{{ project.detail.acquisition_cost|comma }}</td>
                </tr>

                <tr>
                    <td>累计收款</td>
                    <td>{{ project.detail.accumulated_cash_in|comma }}</td>
                </tr>

                <tr>
                    <td>累计付款</td>
                    <td>{{ project.detail.accumulated_cash_out|comma }}</td>
                </tr>

                <tr>
                    <td>应收账款</td>
                    <td>{{ project.detail.accounts_receivable_balance|comma }}</td>
                </tr>

                <tr>
                    <td>应付账款</td>
                    <td>{{ project.detail.accounts_payable_balance|comma }}</td>
                </tr>

                <tr>
                    <td>销项税金</td>
                    <td>{{ project.detail.vat|comma }}</td>
                </tr>

                <tr>
                    <td>进项税金</td>
                    <td>{{ project.detail.vat_input|comma }}</td>
                </tr>
                </tbody>
            </table>

        </div>
        <div class="col-xs-12 col-md">
            <h3 class="text-center">项目初始状态</h3>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">内容</th>
                    <th scope="col">金额</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>累计确认收入</td>
                    <td>{{ project.detail.accumulated_revenue|comma }}</td>
                </tr>
                <tr>
                    <td>累计确认成本</td>
                    <td>{{ project.detail.accumulated_cost|comma }}</td>
                </tr>
                <tr>
                    <td>合同履约成本</td>
                    <td>{{ project.detail.capitalized_cost|comma }}</td>
                </tr>

                <tr>
                    <td>合同资产</td>
                    <td>{{ project.detail.contract_asset|comma }}</td>
                </tr>

                <tr>
                    <td>合同负债</td>
                    <td>{{ project.detail.contract_liability|comma }}</td>
                </tr>

                <tr>
                    <td>合同取得成本</td>
                    <td>{{ project.detail.acquisition_cost|comma }}</td>
                </tr>

                <tr>
                    <td>累计收款</td>
                    <td>{{ project.detail.accumulated_cash_in|comma }}</td>
                </tr>

                <tr>
                    <td>累计付款</td>
                    <td>{{ project.detail.accumulated_cash_out|comma }}</td>
                </tr>

                <tr>
                    <td>应收账款</td>
                    <td>{{ project.detail.accounts_receivable_balance|comma }}</td>
                </tr>

                <tr>
                    <td>应付账款</td>
                    <td>{{ project.detail.accounts_payable_balance|comma }}</td>
                </tr>

                <tr>
                    <td>销项税金</td>
                    <td>{{ project.detail.vat|comma }}</td>
                </tr>

                <tr>
                    <td>进项税金</td>
                    <td>{{ project.detail.vat_input|comma }}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="btn-group mb-2" role="group" aria-label="Basic example">
        <a href="{% url 'projects:project_edit' project.id %}" type="button" class="btn btn-primary">编辑基本信息</a>
        <a href="{% url 'projects:project_edit_initial' project.id %}" type="button" class="btn btn-success">修改初始数据</a>
        <a href="" type="button" class="btn btn-danger" data-toggle="modal" data-target="#exampleModal">删除项目</a>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">删除该项目</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    将删除<span class="text-danger">{{ project.name }}项目</span>所关联的所有数据，删除之后不可恢复！
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">取消</button>
                    <form action="{% url 'projects:project_delete' project.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">确定</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block jscode %}
    $(':text').addClass('form-control');
    $('textarea').addClass('form-control');
    $('#id_active').addClass('form-check-input');
    $('.form-check label').addClass('form-check-label');
{% endblock %}